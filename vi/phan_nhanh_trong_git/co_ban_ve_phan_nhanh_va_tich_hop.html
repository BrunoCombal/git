<!DOCTYPE HTML>
<html lang="en-US">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Cơ Bản Về Phân Nhánh và Tích Hợp | Learn Git</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="GitbookIO">
        <meta name="description" content="The entire Pro Git book.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../phan_nhanh_trong_git/quan_ly_cac_nhanh.html" />
        
        
        <link rel="prev" href="../phan_nhanh_trong_git/nhanh_la_gi.html" />
        

        <meta property="og:title" content="Cơ Bản Về Phân Nhánh và Tích Hợp | Learn Git">
        <meta property="og:site_name" content="Learn Git">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/GitbookIO">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        
    <div class="book" data-github="GitbookIO/git" data-level="3.2" data-basepath=".." data-revision="1397503670765">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/GitbookIO/git" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/GitbookIO/git/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/GitbookIO/git/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1><a href="../" >Learn Git</a></h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/GitbookIO" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/GitbookIO/git/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/GitbookIO/git/edit/master/phan_nhanh_trong_git/co_ban_ve_phan_nhanh_va_tich_hop.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="bat_dau/README.html">
                
                <a href="../bat_dau/README.html">
                    <i class="fa fa-check"></i> <b>1.</b> Bắt Đầu
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="bat_dau/ve_quan_ly_phien_ban.html">
                            
                            <a href="../bat_dau/ve_quan_ly_phien_ban.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> Về Quản Lý Phiên Bản
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="bat_dau/so_luoc_lich_su_cua_git.html">
                            
                            <a href="../bat_dau/so_luoc_lich_su_cua_git.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> Sơ Lược Lịch Sử của Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="bat_dau/co_ban_ve_git.html">
                            
                            <a href="../bat_dau/co_ban_ve_git.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> Cơ Bản về Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="bat_dau/cai_dat_git.html">
                            
                            <a href="../bat_dau/cai_dat_git.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> Cài Đặt Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.5" data-path="bat_dau/cau_hinh_git_lan_dau.html">
                            
                            <a href="../bat_dau/cau_hinh_git_lan_dau.html">
                                <i class="fa fa-check"></i> <b>1.5.</b> Cấu Hình Git Lần Đầu
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.6" data-path="bat_dau/tro_giup.html">
                            
                            <a href="../bat_dau/tro_giup.html">
                                <i class="fa fa-check"></i> <b>1.6.</b> Trợ Giúp
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.7" data-path="bat_dau/tom_tat.html">
                            
                            <a href="../bat_dau/tom_tat.html">
                                <i class="fa fa-check"></i> <b>1.7.</b> Tóm Tắt
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="co_ban_ve_git/README.html">
                
                <a href="../co_ban_ve_git/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Cơ Bản Về Git
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="co_ban_ve_git/tao_mot_kho_chua_git.html">
                            
                            <a href="../co_ban_ve_git/tao_mot_kho_chua_git.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Tạo Một Kho Chứa Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="co_ban_ve_git/ghi_lai_thay_doi_vao_kho_chua.html">
                            
                            <a href="../co_ban_ve_git/ghi_lai_thay_doi_vao_kho_chua.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Ghi Lại Thay Đổi vào Kho Chứa
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="co_ban_ve_git/xem_lich_su_commit.html">
                            
                            <a href="../co_ban_ve_git/xem_lich_su_commit.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Xem Lịch Sử Commit
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.4" data-path="co_ban_ve_git/phuc_hoi.html">
                            
                            <a href="../co_ban_ve_git/phuc_hoi.html">
                                <i class="fa fa-check"></i> <b>2.4.</b> Phục Hồi
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.5" data-path="co_ban_ve_git/lam_viec_tu_xa.html">
                            
                            <a href="../co_ban_ve_git/lam_viec_tu_xa.html">
                                <i class="fa fa-check"></i> <b>2.5.</b> Làm Việc Từ Xa
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.6" data-path="co_ban_ve_git/danh_dau.html">
                            
                            <a href="../co_ban_ve_git/danh_dau.html">
                                <i class="fa fa-check"></i> <b>2.6.</b> Đánh Dấu
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.7" data-path="co_ban_ve_git/meo_nho.html">
                            
                            <a href="../co_ban_ve_git/meo_nho.html">
                                <i class="fa fa-check"></i> <b>2.7.</b> Mẹo Nhỏ
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.8" data-path="co_ban_ve_git/tong_ket.html">
                            
                            <a href="../co_ban_ve_git/tong_ket.html">
                                <i class="fa fa-check"></i> <b>2.8.</b> Tổng Kết
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="phan_nhanh_trong_git/README.html">
                
                <a href="../phan_nhanh_trong_git/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Phân Nhánh Trong Git
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="phan_nhanh_trong_git/nhanh_la_gi.html">
                            
                            <a href="../phan_nhanh_trong_git/nhanh_la_gi.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Nhánh Là Gì?
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="phan_nhanh_trong_git/co_ban_ve_phan_nhanh_va_tich_hop.html">
                            
                            <a href="../phan_nhanh_trong_git/co_ban_ve_phan_nhanh_va_tich_hop.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Cơ Bản Về Phân Nhánh và Tích Hợp
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="phan_nhanh_trong_git/quan_ly_cac_nhanh.html">
                            
                            <a href="../phan_nhanh_trong_git/quan_ly_cac_nhanh.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Quản Lý Các Nhánh
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="phan_nhanh_trong_git/quy_trinh_lam_viec_phan_nhanh.html">
                            
                            <a href="../phan_nhanh_trong_git/quy_trinh_lam_viec_phan_nhanh.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> Quy Trình Làm Việc Phân Nhánh
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="phan_nhanh_trong_git/nhanh_remote.html">
                            
                            <a href="../phan_nhanh_trong_git/nhanh_remote.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> Nhánh Remote
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.6" data-path="phan_nhanh_trong_git/rebasing.html">
                            
                            <a href="../phan_nhanh_trong_git/rebasing.html">
                                <i class="fa fa-check"></i> <b>3.6.</b> Rebasing
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.7" data-path="phan_nhanh_trong_git/tong_ket.html">
                            
                            <a href="../phan_nhanh_trong_git/tong_ket.html">
                                <i class="fa fa-check"></i> <b>3.7.</b> Tổng Kết
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 80%;min-width: 76%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../bat_dau/README.html" title="Bắt Đầu" class="chapter done new-chapter" data-progress="1" style="left: 4%;"></a>
    
        <a href="../bat_dau/ve_quan_ly_phien_ban.html" title="Về Quản Lý Phiên Bản" class="chapter done " data-progress="1.1" style="left: 8%;"></a>
    
        <a href="../bat_dau/so_luoc_lich_su_cua_git.html" title="Sơ Lược Lịch Sử của Git" class="chapter done " data-progress="1.2" style="left: 12%;"></a>
    
        <a href="../bat_dau/co_ban_ve_git.html" title="Cơ Bản về Git" class="chapter done " data-progress="1.3" style="left: 16%;"></a>
    
        <a href="../bat_dau/cai_dat_git.html" title="Cài Đặt Git" class="chapter done " data-progress="1.4" style="left: 20%;"></a>
    
        <a href="../bat_dau/cau_hinh_git_lan_dau.html" title="Cấu Hình Git Lần Đầu" class="chapter done " data-progress="1.5" style="left: 24%;"></a>
    
        <a href="../bat_dau/tro_giup.html" title="Trợ Giúp" class="chapter done " data-progress="1.6" style="left: 28%;"></a>
    
        <a href="../bat_dau/tom_tat.html" title="Tóm Tắt" class="chapter done " data-progress="1.7" style="left: 32%;"></a>
    
        <a href="../co_ban_ve_git/README.html" title="Cơ Bản Về Git" class="chapter done new-chapter" data-progress="2" style="left: 36%;"></a>
    
        <a href="../co_ban_ve_git/tao_mot_kho_chua_git.html" title="Tạo Một Kho Chứa Git" class="chapter done " data-progress="2.1" style="left: 40%;"></a>
    
        <a href="../co_ban_ve_git/ghi_lai_thay_doi_vao_kho_chua.html" title="Ghi Lại Thay Đổi vào Kho Chứa" class="chapter done " data-progress="2.2" style="left: 44%;"></a>
    
        <a href="../co_ban_ve_git/xem_lich_su_commit.html" title="Xem Lịch Sử Commit" class="chapter done " data-progress="2.3" style="left: 48%;"></a>
    
        <a href="../co_ban_ve_git/phuc_hoi.html" title="Phục Hồi" class="chapter done " data-progress="2.4" style="left: 52%;"></a>
    
        <a href="../co_ban_ve_git/lam_viec_tu_xa.html" title="Làm Việc Từ Xa" class="chapter done " data-progress="2.5" style="left: 56%;"></a>
    
        <a href="../co_ban_ve_git/danh_dau.html" title="Đánh Dấu" class="chapter done " data-progress="2.6" style="left: 60%;"></a>
    
        <a href="../co_ban_ve_git/meo_nho.html" title="Mẹo Nhỏ" class="chapter done " data-progress="2.7" style="left: 64%;"></a>
    
        <a href="../co_ban_ve_git/tong_ket.html" title="Tổng Kết" class="chapter done " data-progress="2.8" style="left: 68%;"></a>
    
        <a href="../phan_nhanh_trong_git/README.html" title="Phân Nhánh Trong Git" class="chapter done new-chapter" data-progress="3" style="left: 72%;"></a>
    
        <a href="../phan_nhanh_trong_git/nhanh_la_gi.html" title="Nhánh Là Gì?" class="chapter done " data-progress="3.1" style="left: 76%;"></a>
    
        <a href="../phan_nhanh_trong_git/co_ban_ve_phan_nhanh_va_tich_hop.html" title="Cơ Bản Về Phân Nhánh và Tích Hợp" class="chapter done " data-progress="3.2" style="left: 80%;"></a>
    
        <a href="../phan_nhanh_trong_git/quan_ly_cac_nhanh.html" title="Quản Lý Các Nhánh" class="chapter  " data-progress="3.3" style="left: 84%;"></a>
    
        <a href="../phan_nhanh_trong_git/quy_trinh_lam_viec_phan_nhanh.html" title="Quy Trình Làm Việc Phân Nhánh" class="chapter  " data-progress="3.4" style="left: 88%;"></a>
    
        <a href="../phan_nhanh_trong_git/nhanh_remote.html" title="Nhánh Remote" class="chapter  " data-progress="3.5" style="left: 92%;"></a>
    
        <a href="../phan_nhanh_trong_git/rebasing.html" title="Rebasing" class="chapter  " data-progress="3.6" style="left: 96%;"></a>
    
        <a href="../phan_nhanh_trong_git/tong_ket.html" title="Tổng Kết" class="chapter  " data-progress="3.7" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_256">
                    
                        <h1 id="c-b-n-v-ph-n-nh-nh-v-t-ch-h-p">Cơ Bản Về Phân Nhánh và Tích Hợp</h1>
<p>Hãy cùng xem qua một ví dụ đơn giản về phân nhánh và tích hợp với một quy trình làm việc mà có thể bạn sẽ sử dụng nó vào thực tế. Bạn sẽ thực hiện theo các bước sau: </p>
<ol>
<li>Làm việc trên một web site</li>
<li>Tạo nhánh cho một câu chuyện mới mà bạn đang làm.</li>
<li>Làm việc trên nhánh đó.</li>
</ol>
<p>Đến lúc này, bạn nhận được thông báo rằng có một vấn đề nghiêm trọng cần được khắc phục ngay. Bạn sẽ làm theo các bước sau:</p>
<ol>
<li>Chuyển lại về nhánh sản xuất (production)</li>
<li>Tạo mới một nhánh khác để khắc phục lỗi</li>
<li>Sau khi đã kiểm tra ổn định, tích hợp nhánh đó lại và đưa vào hoạt động.</li>
<li>Chuyển ngược lại với câu chuyện của bạn và tiếp tục làm việc.</li>
</ol>
<h2 id="c-b-n-v-ph-n-nh-nh">Cơ Bản về Phân Nhánh</h2>
<p>Đầu tiên, giả sử bạn đang làm việc trên một dự án đã có một số commit từ trước (xem Hình 3-10).</p>
<p><img src="http://git-scm.com/figures/18333fig0310-tn.png" alt=""></p>
<p>Hình 3-10. Một lịch sử commit ngắn và đơn giản.</p>
<p>Bạn quyết định sẽ giải quyết vấn đề số #53 sử dụng bất kỳ hệ thống giám sát vấn đề (issue-tracking) nào mà công ty bạn đang dùng. Để cho rõ ràng, Git không cung cấp kèm bất kỳ hệ thống giám sát vấn đề nào; nhưng bởi vì vấn đề số #53 là cái mà bạn sẽ tập trung vào nên bạn sẽ tạo một nhánh mới để làm việc trên đó. Để tạo một nhánh và chuyển sang nhánh đó đồng thời, bạn có thể chạy lệnh <code>git checkout</code> với tham số <code>-b</code>:</p>
<pre><code>$ git checkout -b iss53
Switched <span class="hljs-built_in">to</span> <span class="hljs-operator">a</span> <span class="hljs-built_in">new</span> branch <span class="hljs-string">"iss53"</span>
</code></pre><p>Đây là cách sử dụng vắn tắt của:</p>
<pre><code><span class="hljs-variable">$ </span>git branch iss53
<span class="hljs-variable">$ </span>git checkout iss53
</code></pre><p>Hình 3-11 minh họa kết quả.</p>
<p><img src="http://git-scm.com/figures/18333fig0311-tn.png" alt=""></p>
<p>Hình 3-11. Tạo con trỏ nhánh mới.</p>
<p>Bạn làm việc trên đó và sau đó thực hiện một số commit. Làm như vậy sẽ khiến nhánh <code>iss53</code> di chuyển tiến lên, vì bạn đã checkout nó (hay, HEAD đang trỏ đến nó; xem Hình 3-12):</p>
<pre><code><span class="hljs-variable">$ </span>vim index.html
<span class="hljs-variable">$ </span>git commit -a -m <span class="hljs-string">'added a new footer [issue 53]'</span>
</code></pre><p><img src="http://git-scm.com/figures/18333fig0312-tn.png" alt=""></p>
<p>Hình 3-12. Nhánh iss53 đã di chuyển tiến lên cùng với thay đổi của bạn.</p>
<p>Bây giờ bạn nhận được thông báo rằng có một vấn đề với trang web, và bạn cần khắc phục nó ngay lập tức. Với Git, bạn không phải triển khai bản vá lỗi cùng với các thay đổi bạn đã thực hiện trên nhánh <code>iss53</code>, và bạn không phải tốn quá nhiều công sức để khôi phục lại các thay đổi đó trước khi áp dụng bản vá vào sản xuất. Tất cả những gì bạn cần phải làm là chuyển lại nhánh master.</p>
<p>Tuy nhiên, trước khi làm điều này, bạn nên lưu ý rằng nếu thư mục làm việc hoặc khu vực tổ chức có chứa các thay đổi chưa được commit mà xung đột với nhánh bạn đang làm việc, Git sẽ không cho phép bạn chuyển nhánh. Tốt nhất là bạn nên ở trạng thái làm việc &quot;sạch&quot; (đã commit hết) trước khi chuyển nhánh. Có các cách khác để khắc phục vấn đề này (đó là stashing và sửa commit) mà chúng ta sẽ bàn tới sau. Hiện tại, bạn đã commit hết các thay đổi, vì vậy bạn có thể chuyển lại nhánh master:</p>
<pre><code><span class="hljs-variable">$ </span>git checkout master
<span class="hljs-constant">Switched</span> to branch <span class="hljs-string">"master"</span>
</code></pre><p>Tại thời điểm này, thư mục làm việc của dự án giống hệt như trước khi bạn bắt đầu giải quyết vấn đề #53, và bạn có thể tập trung vào việc sửa lỗi. Điểm quan trọng cần ghi nhớ: Git khôi phục lại thư mục làm việc của bạn để nó giống như snapshot của commit mà nhánh bạn đang làm việc trỏ tới. Nó thêm, xóa, và sửa các tập tin một cách tự động để đảm bảo rằng thư mục làm việc của bạn giống như lần commit cuối cùng.</p>
<p>Tiếp theo, bạn có mỗi lỗi cần phải sửa. Hãy tạo mỗi nhánh để làm việc này cho tới khi nó được hoàn thành (xem Hình 3-13):</p>
<pre><code>$ git checkout <span class="hljs-attribute">-b</span> hotfix
Switched <span class="hljs-keyword">to</span> a <span class="hljs-literal">new</span> branch <span class="hljs-string">"hotfix"</span>
$ vim index<span class="hljs-built_in">.</span>html
$ git commit <span class="hljs-attribute">-a</span> <span class="hljs-attribute">-m</span> <span class="hljs-string">'fixed the broken email address'</span>
<span class="hljs-preprocessor">[</span>hotfix<span class="hljs-preprocessor">]</span><span class="hljs-markup">: created 3a0874c: "fixed the broken email address"
 1 files changed, 0 insertions(+), 1 deletions(-)</span>
</code></pre><p><img src="http://git-scm.com/figures/18333fig0313-tn.png" alt=""></p>
<p>Hình 3-13. Nhánh hotfix dựa trên nhánh master.</p>
<p>Bạn có thể chạy để kiểm tra, để chắc chắn rằng bản vá lỗi hoạt động đúng theo ý bạn muốn, và sau đó tích hợp nó lại nhánh chính để triển khai. Bạn có thể làm sử dụng lệnh <code>git merge</code> để làm việc này:</p>
<pre><code><span class="hljs-variable">$ </span>git checkout master
<span class="hljs-variable">$ </span>git merge hotfix
<span class="hljs-constant">Updating</span> f42c576..<span class="hljs-number">3</span>a0874c
<span class="hljs-constant">Fast</span> forward
 <span class="hljs-constant">README</span> |    <span class="hljs-number">1</span> -
 <span class="hljs-number">1</span> files changed, <span class="hljs-number">0</span> insertions(+), <span class="hljs-number">1</span> deletions(-)
</code></pre><p>Bạn sẽ nhận thấy rằng cụm từ &quot;Fast forward&quot; trong lần tích hợp đó. Bởi vì commit được trở tới bởi nhánh mà bạn tích hợp vào lại trực tiếp là upstream của commit hiện tại, vì vậy Git di chuyển con trỏ về phía trước. Nói cách khác, khi bạn cố gắng tích hợp một commit với một commit khác mà có thể truy cập được từ lịch sử của commit trước thì Git sẽ đơn giản hóa bằng cách di chuyển con trỏ về phía trước vì không có sự rẽ nhánh nào để tích hợp - đây được gọi là &quot;fast forward&quot;.</p>
<p>Thay đổi của bạn bây giờ ở trong snapshot của commit được trỏ tới bởi nhánh <code>master</code>, và bạn có thể triển khai thay đổi này (xem Hình 3-14).</p>
<p><img src="http://git-scm.com/figures/18333fig0314-tn.png" alt=""></p>
<p>Hình 3-14. Nhánh master và nhánh hotfix cùng trỏ tới một điểm sau khi tích hợp.</p>
<p>Sau khi triển khai xong bản vá lỗi quan trọng đó, bạn đã sẵn sàng để quay lại với công việc bị gián đoạn trước đó. Tuy nhiên, việc đầu tiên cần làm là xóa nhánh <code>hotfix</code> đi, vì bạn không còn cần tới nó nữa - nhánh <code>master</code> trỏ tới cùng một điểm. Bạn có thể xóa nó đi bằng cách sử dụng tham số <code>-d</code> cho lệnh <code>git branch</code>:</p>
<pre><code>$ git branch <span class="hljs-operator">-d</span> hotfix
Deleted branch hotfix (<span class="hljs-number">3</span>a0874c).
</code></pre><p>Bây giờ bạn đã có thể chuyển lại nhánh mà bạn đang làm việc trước đó về vấn đề #53 và tiếp tục làm việc (xem Hình 3-15):</p>
<pre><code><span class="hljs-variable">$ </span>git checkout iss53
<span class="hljs-constant">Switched</span> to branch <span class="hljs-string">"iss53"</span>
<span class="hljs-variable">$ </span>vim index.html
<span class="hljs-variable">$ </span>git commit -a -m <span class="hljs-string">'finished the new footer [issue 53]'</span>
[iss53]<span class="hljs-symbol">:</span> created <span class="hljs-symbol">ad82d7a:</span> <span class="hljs-string">"finished the new footer [issue 53]"</span>
 <span class="hljs-number">1</span> files changed, <span class="hljs-number">1</span> insertions(+), <span class="hljs-number">0</span> deletions(-)
</code></pre><p><img src="http://git-scm.com/figures/18333fig0315-tn.png" alt=""></p>
<p>Hình 3-15. Nhánh iss53 có thể di chuyển về phía trước một cách độc lập.</p>
<p>Điều đáng chú ý ở đây là những công việc bạn đã thực hiện ở nhánh <code>hotfix</code> không bao gồm trong nhánh <code>iss53</code>. Nếu bạn muốn đưa chúng vào, bạn có thể tích hợp nhánh <code>master</code> vào nhánh <code>iss53</code> bằng cách chạy lệnh <code>git merge master</code>, hoặc bạn có thể chờ đợi đến khi bạn quyết định tích hợp nhánh <code>iss53</code> ngược trở lại nhánh <code>master</code> về sau.</p>
<h2 id="c-b-n-v-t-ch-h-p">Cơ Bản Về Tích Hợp</h2>
<p>Giả sử bạn đã quyết định việc giải quyết vấn đề #53 đã hoàn thành và sẵn sàng để tích hợp vào nhánh <code>master</code>. Để làm được điều này, bạn sẽ tích hợp nhánh <code>iss53</code> lại, giống như bạn đã làm với nhánh <code>hotfix</code> trước đó. Tất cả những gì cần phải làm là chuyển sang (check out) nhánh mà bạn muốn được tích hợp vào và chạy lệnh <code>git merge</code>:</p>
<pre><code>$ git checkout master
$ git <span class="hljs-operator"><span class="hljs-keyword">merge</span> iss53
<span class="hljs-keyword">Merge</span> made <span class="hljs-keyword">by</span> recursive.
 README |    <span class="hljs-number">1</span> +
 <span class="hljs-number">1</span> files changed, <span class="hljs-number">1</span> insertions(+), <span class="hljs-number">0</span> deletions(-)</span>
</code></pre><p>Lần này có hơi khác so với lần tích hợp <code>hotfix</code> trước đó. Trong trường hợp này, lịch sử phát triển của bạn đã bị phân nhánh tại một thời điểm nào đó trước kia. Bởi vì commit trên nhánh mà bạn đang làm việc (master) không phải là &quot;cha&quot; trực tiếp của nhánh mà bạn đang tích hợp vào, Git phải làm một số việc. Trường hợp này, Git thực hiện một tích hợp 3-chiều, sử dụng hai snapshot được trỏ tới bởi các đầu mút của nhánh và &quot;cha chung&quot; của cả hai. Hình 3-16 minh họa ba snapshot mà Git sử dụng để thực hiện phép tích hợp trong trường hợp này.</p>
<p><img src="http://git-scm.com/figures/18333fig0316-tn.png" alt=""></p>
<p>Hình 3-16. Git tự động nhận dạng &quot;cha chung&quot; phù hợp nhất để tích hợp các nhánh lại với nhau.</p>
<p>Thay vì việc chỉ di chuyển con trỏ về phía trước, Git tạo một snapshot mới - được hợp thành từ lần tích hợp 3-chiều này và cũng tự tạo một commit mới trỏ tới nó (xem Hình 3-17). Nó được biết tới như là &quot;commit tích hợp&quot; (merge commit) và nó đặc biệt vì có nhiều hơn một cha.</p>
<p>Đáng để chỉ ra rằng Git tự quyết định cha chung phù hợp nhất để sử dụng làm cơ sở cho việc tích hợp; điểm này khác với CVS hay Subversion (các phiên bản trước 1.5), khi mà các lập trình viên phải tự xác định cơ sở phù hợp nhất để tích hợp. Điều này khiến cho việc tích hợp trong Git trở nên dễ dàng hơn rất nhiều so với các hệ quản trị phiên bản khác.</p>
<p><img src="http://git-scm.com/figures/18333fig0317-tn.png" alt=""></p>
<p>Hình 3-17. Git tự động tạo đối tượng commit mới chứa đựng các thay đổi đã tích hợp.</p>
<p>Bây giờ công việc của bạn đã được tích hợp lại với nhau, bạn không cần thiết phải giữ lại nhánh <code>iss53</code> nữa. Bạn có thể xóa nó đi và sau đó tự xóa vấn đề này trong hệ thống quản lý vấn đề của bạn:</p>
<pre><code>$ git branch <span class="hljs-operator">-d</span> iss53
</code></pre><h2 id="m-u-thu-n-khi-t-ch-h-p">Mâu Thuẫn Khi Tích Hợp</h2>
<p>Đôi khi, quá trình này không diễn ra một cách suôn sẻ. Nếu bạn thay đổi cùng một nội dung của cùng một tập tin ở hai nhánh khác nhau mà bạn đang muốn tích hợp vào, Git không thể tích hợp chúng một cách gọn gàng. Nếu bản vá lỗi cho vấn đề #53 cùng thay đổi một phần của một tập tin giống như nhánh <code>hotfix</code>, bạn sẽ nhận được một sự xung đột khi tiến hành tích hợp như sau:</p>
<pre><code>$ git <span class="hljs-built_in">merge</span> iss53
Auto-merging index.html
CONFLICT (content): Merge conflict <span class="hljs-operator">in</span> index.html
Automatic <span class="hljs-built_in">merge</span> failed; fix conflicts <span class="hljs-operator">and</span> <span class="hljs-keyword">then</span> commit <span class="hljs-operator">the</span> <span class="hljs-built_in">result</span>.
</code></pre><p>Git chưa tự tạo commit tích hợp mới. Nó tạm dừng quá trình này lại cho đến khi bạn giải quyết xong xung đột. Nếu bạn muốn xem tập tin nào chưa được tích hợp tại bất kỳ thời điểm nào sau khi xung đột xảy ra, bạn có thể sử dụng lệnh <code>git status</code>:</p>
<pre><code>[master*]$ git status
index.html: needs merge
<span class="hljs-preprocessor"># On branch master</span>
<span class="hljs-preprocessor"># Changes not staged for commit:</span>
<span class="hljs-preprocessor">#   (use "git add &lt;file&gt;..." to update what will be committed)</span>
<span class="hljs-preprocessor">#   (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span>
<span class="hljs-preprocessor">#</span>
<span class="hljs-preprocessor">#    unmerged:   index.html</span>
<span class="hljs-preprocessor">#</span>
</code></pre><p>Với bất kỳ xung đột nào xảy ra mà chưa được giải quyết, chúng sẽ được liệt kê là unmerged (chưa được tích hợp). Git thêm các dấu hiệu chuẩn riêng để giải quyết xung đột vào các tập tin có xảy ra xung đột, vì thế bạn có thể mở và giải quyết các xung đột đó một cách thủ công. Tập tin của bạn sẽ chứa một phần tương tự như sau:</p>
<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:index.html
<span class="hljs-header">&lt;div id="footer"&gt;contact : email.support@github.com&lt;/div&gt;
=======</span>
&lt;div id="footer"&gt;
<span class="hljs-code">  please contact us at support@github.com</span>
&lt;/div&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; iss53:index.html
</code></pre><p>Điều này có nghĩa là phiên bản trong HEAD (nhánh master, vì nó là nhánh bạn đã check out khi chạy lệnh merge) là phần mới nhất của đoạn đó (mọi thứ phía trên <code>=======</code>), trong khi phiên bản ở nhánh <code>iss53</code> chính là phần phía dưới. Để giải quyết vấn đề này, bạn phải chọn một trong hai phần hoặc tự gộp nội dung của chúng lại. Ví dụ, có thể bạn giải quyết xung đột này bằng cách thay thế toàn bộ đoạn code đó bằng:</p>
<pre><code>&lt;<span class="hljs-keyword">div</span> <span class="hljs-property">id</span>=<span class="hljs-string">"footer"</span>&gt;
please contact us <span class="hljs-keyword">at</span> email.support@github.com
&lt;/<span class="hljs-keyword">div</span>&gt;
</code></pre><p>Cách giải quyết này có chứa nội dung của cả hai phần, và tôi đã xóa bỏ hoàn toàn các dòng <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>, <code>=======</code>, và <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>. Sau khi giải quyết xong tất cả các phần này trong các tập tin bị xung đột, chạy lệnh <code>git add</code> cho từng tập tin để đánh dấu là chúng đã được giải quyết. Tổ chức chúng cùng đồng nghĩa với việc đánh dấu là đã được giải quyết trong Git. Nếu bạn muốn sử dụng một công cụ có giao diện đồ họa để giải quyết những vấn đề này, bạn có thể sử dụng <code>git mergetool</code>, Git sẽ tự động mở chương trình tương ứng và trợ giúp bạn giải quyết các xung đột: </p>
<pre><code>$ git mergetool
<span class="hljs-built_in">merge</span> tool candidates: kdiff3 tkdiff xxdiff meld gvimdiff opendiff emerge vimdiff
Merging <span class="hljs-operator">the</span> <span class="hljs-built_in">files</span>: index.html

Normal <span class="hljs-built_in">merge</span> conflict <span class="hljs-keyword">for</span> <span class="hljs-string">'index.html'</span>:
  {<span class="hljs-built_in">local</span>}: modified
  {remote}: modified
Hit <span class="hljs-constant">return</span> <span class="hljs-built_in">to</span> start <span class="hljs-built_in">merge</span> resolution tool (opendiff):
</code></pre><p>Nếu bạn muốn sử dụng một công cụ tích hợp khác thay vì chương trình mặc định (Git sử dụng <code>opendiff</code> cho tôi trong trường hợp này vì tôi đang sử dụng một máy tính Mac), bạn có thể xem danh sách các chương trình tương thích bằng cách chạy lệnh &quot;merge tool candidates&quot;. Gõ tên chương trình bạn muốn sử dung. Trong Chương 7, chúng ta sẽ cùng bàn luận về việc làm thế nào để thay đổi giá trị mặc định này.</p>
<p>Sau khi thoát khỏi chương trình hỗ trợ tích hợp, Git sẽ hỏi bạn nếu tích hợp thành công. Nếu bạn trả lời đúng, nó sẽ đánh dấu tập tin đó là đã giải quyết cho bạn.</p>
<p>Bạn có thể chạy <code>git status</code> lại một lần nữa để xác thực rằng tất cả các xung đột đã được giải quyết:</p>
<pre><code>$ git status
<span class="hljs-preprocessor"># On branch master</span>
<span class="hljs-preprocessor"># Changes to be committed:</span>
<span class="hljs-preprocessor">#   (use "git reset HEAD &lt;file&gt;..." to unstage)</span>
<span class="hljs-preprocessor">#</span>
<span class="hljs-preprocessor">#    modified:   index.html</span>
<span class="hljs-preprocessor">#</span>
</code></pre><p>Nếu bạn hài lòng với điều này, và chắc chắn rằng tất cả các xung đột đã được tổ chức, bạn có thể chạy lệnh <code>git commit</code> để hoàn thành commit tích hợp. Thông điệp mặc định của commit có dạng như sau:</p>
<pre><code>Merge branch <span class="hljs-string">'iss53'</span>

Conflicts:
  index.html
<span class="hljs-preprocessor">#</span>
<span class="hljs-preprocessor"># It looks like you may be committing a MERGE.</span>
<span class="hljs-preprocessor"># If this is not correct, please remove the file</span>
<span class="hljs-preprocessor"># .git/MERGE_HEAD</span>
<span class="hljs-preprocessor"># and try again.</span>
<span class="hljs-preprocessor">#</span>
</code></pre><p>Bạn có sửa lại nội dung này với các chi tiết về việc bạn đã giải quyết như thế nào nếu bạn cho rằng các thông tin đó sẽ có ích cho các thành viên khác sau này - tại sao bạn lại làm như vậy, nếu như chúng còn chưa rõ ràng.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../phan_nhanh_trong_git/nhanh_la_gi.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../phan_nhanh_trong_git/quan_ly_cac_nhanh.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
        <link rel="stylesheet" href="../gitbook/style.css">
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        
    </body>
</html>
